# 📜 脚本使用说明

## 两个启动脚本的区别

### 🎯 快速选择

```bash
# 首次部署 → 使用 init-setup.sh
./init-setup.sh
docker compose up -d

# 日常启动 → 使用 start.sh（已更新，会检查依赖）
./start.sh
```

---

## 📋 详细对比

### `init-setup.sh` - 初始化脚本

**适用场景**：
- ✅ 第一次部署项目
- ✅ 环境重置（清理后重新开始）
- ✅ 拉取新代码后
- ✅ 依赖出现问题需要修复

**功能清单**：
```
✓ 检查项目目录结构
✓ 安装前端依赖（npm install）
✓ 生成 package-lock.json
✓ 创建 .env 配置文件
✓ 验证 Docker 环境
✓ 检查所有必需文件
✗ 不启动服务（需要手动启动）
```

**执行步骤**：
```bash
# 运行初始化
./init-setup.sh

# 看到 "🎉 初始化完成！" 后
# 手动启动服务
docker compose up -d
```

---

### `start.sh` - 快速启动脚本（已优化）

**适用场景**：
- ✅ 已完成初始化，日常启动
- ✅ 服务器重启后恢复
- ✅ 测试部署是否正常
- ✅ 快速启动（会自动检查并提示安装依赖）

**功能清单**：
```
✓ 检查 Docker 环境
✓ 检查前端依赖（新增）
✓ 提示安装依赖（如果缺失）
✓ 创建 .env（如果不存在）
✓ 自动启动 Docker 服务
✓ 显示服务状态
✓ 显示访问地址和常用命令
```

**执行步骤**：
```bash
# 一键启动
./start.sh

# 如果缺少依赖，会提示：
# "是否现在安装前端依赖？(y/n)"
# 输入 y 自动安装，输入 n 跳过
```

---

## 🎬 推荐使用流程

### 场景1：首次部署（完整流程）

```bash
# 方式A：分步执行（推荐，更清晰）
./init-setup.sh       # 准备环境
docker compose up -d  # 启动服务

# 方式B：使用start.sh（会自动检查）
./start.sh           # 检测到缺少依赖会提示安装
```

### 场景2：日常启动

```bash
# 已经初始化过
./start.sh           # 快速启动
```

### 场景3：重新部署

```bash
# 清理环境
docker compose down -v
rm -rf frontend/node_modules

# 重新初始化
./init-setup.sh
docker compose up -d
```

---

## ⚡ 对比表格

| 特性 | init-setup.sh | start.sh (新) |
|------|--------------|---------------|
| **npm install** | ✅ 自动执行 | ⚠️ 检查并提示 |
| **启动Docker** | ❌ 需手动 | ✅ 自动启动 |
| **检查项目文件** | ✅ 详细检查 | ⚠️ 基本检查 |
| **交互性** | ❌ 全自动 | ✅ 可选安装 |
| **执行时间** | 较慢（安装依赖）| 快速 |
| **推荐场景** | 首次/重置 | 日常使用 |

---

## 💡 使用建议

### 1. 首次使用？

```bash
# 使用init-setup.sh，更安全更完整
./init-setup.sh
docker compose up -d
```

### 2. 已经初始化？

```bash
# 使用start.sh，更快速
./start.sh
```

### 3. 不确定？

```bash
# 使用start.sh，它会检查并提示你
./start.sh

# 如果提示缺少依赖，选择 y 安装
# 或者返回使用 init-setup.sh
```

---

## 🔧 手动部署（不使用脚本）

如果你想完全手动控制：

```bash
# 1. 安装前端依赖
cd frontend
npm install
cd ..

# 2. 配置环境
cat > .env << EOF
MYSQL_ROOT_PASSWORD=your_password
VITE_API_URL=/api
EOF

# 3. 启动服务
docker compose up -d

# 4. 查看状态
docker compose ps
```

---

## ❓ 常见问题

### Q: 两个脚本可以一起用吗？

A: 可以！推荐流程：
```bash
./init-setup.sh      # 首次使用
./start.sh          # 后续启动
```

### Q: 忘记先运行 init-setup.sh 怎么办？

A: 没关系！新版 `start.sh` 会检测并提示你安装依赖。

### Q: 哪个更快？

A: 
- `init-setup.sh`: 较慢（需要npm install）
- `start.sh`: 快速（依赖已安装的情况下）

### Q: 我应该用哪个？

A:
- **第一次**: 用 `init-setup.sh`（安全完整）
- **日常用**: 用 `start.sh`（快速方便）
- **不确定**: 用 `start.sh`（会提示你）

---

## 📝 总结

```
首次部署流程：
./init-setup.sh  →  docker compose up -d  →  成功！

日常启动流程：
./start.sh  →  成功！

重置流程：
docker compose down -v  →  ./init-setup.sh  →  docker compose up -d
```

**建议**：两个脚本都保留，根据场景选择使用。

