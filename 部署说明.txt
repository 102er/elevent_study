🌈 儿童识字乐园 - 部署说明
================================

已修复的问题：
✅ 1. Docker构建上下文配置（docker-compose.yml）
✅ 2. npm ci 改为 npm install（frontend/Dockerfile）
✅ 3. 后端添加curl支持健康检查（backend/Dockerfile）

📋 首次部署步骤
================================

步骤1：安装前端依赖
------------------
cd frontend
npm install
cd ..

说明：这会生成 package-lock.json 文件，Docker构建需要此文件

步骤2：配置环境变量
------------------
创建 .env 文件：

cat > .env << 'EOF'
MYSQL_ROOT_PASSWORD=literacy2024
VITE_API_URL=/api
EOF

说明：可以修改密码以提高安全性

步骤3：启动Docker服务
------------------
docker compose up -d

说明：
- 首次启动会下载镜像，可能需要5-10分钟
- 使用 -d 参数在后台运行

步骤4：查看服务状态
------------------
docker compose ps

应该看到3个服务都是 Up 状态：
✓ literacy-mysql
✓ literacy-backend
✓ literacy-frontend

步骤5：访问应用
------------------
浏览器打开：http://localhost


🔧 常用命令
================================

查看日志：
docker compose logs -f

查看特定服务日志：
docker compose logs -f backend
docker compose logs -f frontend
docker compose logs -f mysql

重启服务：
docker compose restart

停止服务：
docker compose stop

完全删除（包括数据）：
docker compose down -v

重新构建：
docker compose build
docker compose up -d


❓ 常见问题
================================

Q: npm install 很慢怎么办？
A: 使用国内镜像源：
   npm config set registry https://registry.npmmirror.com

Q: 端口被占用？
A: 修改 docker-compose.yml 中的端口映射，例如：
   ports:
     - "8080:80"  # 使用8080代替80

Q: 数据库连接失败？
A: 等待MySQL完全启动（约30秒），然后：
   docker compose restart backend

Q: 前端显示"加载数据失败"？
A: 检查后端API是否正常：
   curl http://localhost:5000/api/health


📁 项目结构
================================

eleven_study/
├── frontend/              前端React应用
│   ├── src/              源代码
│   ├── package.json      依赖配置
│   ├── Dockerfile        Docker配置
│   └── nginx.conf        Nginx配置
├── backend/              后端Flask API
│   ├── app.py           主程序
│   ├── requirements.txt Python依赖
│   └── Dockerfile       Docker配置
├── docker-compose.yml   Docker编排
├── init.sql            数据库初始化
├── init-setup.sh       初始化脚本
└── .env               环境变量配置


📚 更多文档
================================

- README.md - 项目介绍
- QUICKSTART.md - 快速开始指南
- DEPLOYMENT.md - 详细部署文档


💡 提示
================================

1. 首次部署前务必运行 npm install
2. 修改默认MySQL密码提高安全性
3. 定期备份数据库
4. 生产环境建议配置HTTPS
5. 查看日志排查问题


🎉 部署成功后
================================

访问 http://localhost 即可开始使用！

功能包括：
✓ 学习看板
✓ 汉字库管理
✓ 学习模式
✓ 周统计（新功能）
✓ 奖励系统

每学会一个汉字获得10颗星星！

